!function(){function t(){function t(){}var e,n,r,a=s();return t.width=function(t){return 0===arguments.length?n:(n=t,this)},t.height=function(t){return 0===arguments.length?r:(r=t,this)},t.accept=function(t,e){var n=i(t,e);return"number"==n.type},t.variable=function(t){return 0===arguments.length?e:(e=t,this)},t.domain=function(t){return 0===arguments.length?a.domain():void 0===e?this:(a.domain(d3.extent(t,function(t){return t[e]})),this)},t.ticks=function(){return a.ticks()},t.scale=function(n){return"object"==typeof n?t.scale(n[e]):a(n)},t}function e(){function t(){}var e,n,r,a=d();return t.width=function(t){return 0===arguments.length?n:(n=t,this)},t.height=function(t){return 0===arguments.length?r:(r=t,this)},t.accept=function(t,e){var n=i(t,e);return"categorical"==n.type},t.variable=function(t){return 0===arguments.length?e:(e=t,this)},t.domain=function(t,n){if(0===arguments.length)return a.domain();if(void 0===e)return this;var r=i(e,n),o=r.categories.map(function(t){return t.name});return a.domain(o),this},t.ticks=function(){return a.ticks()},t.scale=function(t){return a("object"==typeof t?t[e]:t)},t}function n(t){function e(n){var r=e.ticks();if(n.append("rect").attr("class","background").attr("width",e.width()).attr("height",e.height()),t)n.selectAll(".tick").data(r).enter().append("line").attr("class","tick").attr("x1",o).attr("x2",o).attr("y1",0).attr("y2",u.tick_length),n.selectAll(".ticklabel").data(r).enter().append("text").attr("class","ticklabel").attr("x",o).attr("y",u.tick_length+u.tick_padding).text(function(t){return t}).attr("text-anchor","middle").attr("dy","0.71em");else{var a=e.width();n.selectAll(".tick").data(r).enter().append("line").attr("class","tick").attr("x1",a-u.tick_length).attr("x2",a).attr("y1",o).attr("y2",o),n.selectAll(".ticklabel").data(r).enter().append("text").attr("class","ticklabel").attr("x",u.padding).attr("y",o).text(function(t){return t}).attr("text-anchor","begin").attr("dy","0.35em")}}var n,r,a,o=h(),l=t,u={tick_length:5,tick_padding:2,padding:4},s=d3.select("body").append("svg").attr("class","linearaxis dummy").style("visibility","invisible"),d=c(s);return o.label_size(l?d.width:d.height),e.width=function(t){if(l)return 0===arguments.length?r:(r=t,o.range([0,r]),this);if(0===arguments.length){if(void 0===r){for(var e=o.ticks(),n=0,a=0;a<e.length;++a){var i=d.width(e[a]);i>n&&(n=i)}r=n+u.tick_length+u.tick_padding+u.padding}return r}return r=t,this},e.height=function(t){if(l){if(0===arguments.length){if(void 0===a){for(var e=o.ticks(),n=0,r=0;r<e.length;++r){var i=d.height(e[r]);i>n&&(n=i)}a=n+u.tick_length+u.tick_padding+u.padding}return a}return a=t,this}return 0===arguments.length?a:(a=t,o.range([a,0]),this)},e.accept=function(t,e){var n=i(t,e);return"number"==n.type},e.variable=function(t){return 0===arguments.length?n:(n=t,this)},e.domain=function(t){if(0===arguments.length)return o.domain();var e=d3.extent(t,function(t){return t[n]});return o.domain(e).nice(),this},e.ticks=function(){return o.ticks()},e.scale=function(t){return o("object"==typeof t?t[n]:t)},e}function r(){function t(){}function e(t,e,r){if(void 0!==n){var a=i(n,e);void 0!==a.map&&a.map!=o&&(c=!0,d3.json(a.map,function(t){o=a.map,r(t),c=!1}))}}var n,r,a,o,l,u={};t.width=function(t){return 0===arguments.length?r:(s=s||r!=t,r=t,this)},t.height=function(t){return 0===arguments.length?a:(s=s||a!=t,a=t,this)},t.accept=function(t,e){var n=i(t,e);return"string"==n.type},t.variable=function(t){return 0===arguments.length?n:(n=t,this)};var c=!1;t.map_loaded=function(){return!c},t.domain=function(t,r){return 0!==arguments.length?(e(t,r,function(t){l=t,s=!0;var e=i(n,r),a=e.regionid||"id";for(var o in l.features){var c=l.features[o].properties[a];u[c]=o}}),this):void 0},t.scale=function(e){return"object"==typeof e?t.scale(e[n]):(t.update_projection(),h(l.features[u[e]]))};var s=!0,d=d3.geo.transverseMercator().rotate([-5.38720621,-52.1551744]).scale(1).translate([0,0]),h=d3.geo.path().projection(d);return t.update_projection=function(){if(s&&l){d.scale(1).translate([0,0]),h=d3.geo.path().projection(d);var t=h.bounds(l),e=.95/Math.max((t[1][0]-t[0][0])/r,(t[1][1]-t[0][1])/a),n=[(r-e*(t[1][0]+t[0][0]))/2,(a-e*(t[1][1]+t[0][1]))/2];d.scale(e).translate(n),s=!1}},t}function a(){function t(){}var e,n,r,a;return t.width=function(t){return 0===arguments.length?n:(n=t,this)},t.height=function(t){return 0===arguments.length?r:(r=t,this)},t.accept=function(t,e){var n=i(t,e);return"categorical"==n.type},t.variable=function(t){return 0===arguments.length?e:(e=t,this)},t.domain=function(t,n){if(0===arguments.length)return a;if(void 0===e)return this;var r=i(e,n);return a=r.categories.map(function(t){return t.name}),this},t.ticks=function(){return a},t.scale=function(t){return a.indexOf(t)},t}function i(t,e){for(var n=0;n<e.fields.length;n++)if(e.fields[n].name==t)return e.fields[n];return void 0}function o(t,e,n){var r,a,i,o;return n.axes=function(){return d3.keys(t)},n.width=function(t){return 0===arguments.length?r:(r=t,this)},n.height=function(t){return 0===arguments.length?a:(a=t,this)},n.accept=function(e,n){if(arguments.length>1)return void 0===t[n]?!1:t[n].accept(e,o);for(var r in t)if(void 0===e[r]){if(t[r].required)return!1}else{var a=t[r].accept(e[r],o);if(!a)return!1}return!0},n.assign=function(e){for(var n in t)t[n].variable(e[n]);return this},n.schema=function(t){return 0===arguments.length?o:(o=t,this)},n.data=function(t,e){return 0===arguments.length?i:(i=t,arguments.length>1&&n.schema(e),this)},n.dispatch=function(){return e},n}function l(){var t={x:n(!0),y:n(!1),colour:e(),column:a(),row:a()};t.x.required=!0,t.y.required=!0;var r={padding:[2,2,2,2],label_padding:4,sep:8,point_size:4},l=d3.dispatch("mouseover","mouseout","pointover","pointout"),u=d3.select("body").append("svg").attr("class","lineargraph dummy").style("visibility","invisible"),s=c(u),d=o(t,l,function(e){function n(e){return t.colour.variable()?e[t.colour.variable()]:1}function a(e){return t.column.variable()?e[t.column.variable()]:1}function o(e){return t.row.variable()?e[t.row.variable()]:1}t.colour.domain(d.data(),d.schema()),t.column.domain(d.data(),d.schema()),t.row.domain(d.data(),d.schema());for(var u,c,h=t.column.variable()?t.column.ticks().length:1,g=t.row.variable()?t.row.ticks().length:1,f=i(t.x.variable(),schema),v=f.title,p=s.height(v)+r.label_padding,m=i(t.y.variable(),schema),y=m.title,x=0;2>x;++x)u=d.width()-r.padding[1]-r.padding[3]-t.y.width()-p,u=(u-(h-1)*r.sep)/h,t.x.width(u).domain(d.data(),d.schema()),c=d.height()-r.padding[0]-r.padding[2]-t.x.height()-p,c=(c-(g-1)*r.sep)/g,t.y.height(c).domain(d.data(),d.schema());var b=t.y.width()+r.padding[1]+p,k=r.padding[2],w=k+.5*(d.height()-r.padding[0]-r.padding[2]-t.x.height()-p),A=b+.5*(d.width()-r.padding[1]-r.padding[3]-t.y.width()-p);e.append("text").attr("x",r.padding[1]).attr("y",w).attr("text-anchor","middle").text(y).attr("transform","rotate(90 "+r.padding[1]+" "+w+")"),e.append("text").attr("x",A).attr("y",d.height()-r.padding[0]).attr("text-anchor","middle").text(v);var _=d3.nest().key(a).key(o).key(n).entries(d.data());for(x=0;x<_.length;++x){var M=_[x].values;k=r.padding[2];for(var j=0;j<M.length;++j){j==M.length-1&&e.append("g").attr("class","xaxis").attr("transform","translate("+b+","+(k+c)+")").call(t.x),0===x&&e.append("g").attr("class","xaxis").attr("transform","translate("+(b-t.y.width())+","+k+")").call(t.y);var q=e.append("g").attr("class","graph").attr("transform","translate("+b+","+k+")");q.append("rect").attr("class","background").attr("width",u).attr("height",c);var N=t.x.ticks();q.selectAll("line.gridx").data(N).enter().append("line").attr("class","grid gridx").attr("x1",t.x.scale).attr("x2",t.x.scale).attr("y1",0).attr("y2",c);var z=t.y.ticks();q.selectAll("line.gridy").data(z).enter().append("line").attr("class","grid gridy").attr("x1",0).attr("x2",u).attr("y1",t.y.scale).attr("y2",t.y.scale);var B=q.append("g").classed("crosshairs",!0);B.append("line").classed("hline",!0).attr("x1",0).attr("y1",0).attr("x2",t.x.width()).attr("y2",0).style("visibility","hidden"),B.append("line").classed("vline",!0).attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",t.y.height()).style("visibility","hidden");for(var O=d3.svg.line().x(t.x.scale).y(t.y.scale),S=M[j].values,$=0;$<S.length;++$)q.append("path").attr("d",O(S[$].values)).attr("class",t.colour.scale(S[$].key)).datum(S[$]);for(S=M[j].values,$=0;$<S.length;++$){q.selectAll("circle.circle"+$).data(S[$].values).enter().append("circle").attr("class","circle"+$+" "+t.colour.scale(S[$].key)).attr("cx",t.x.scale).attr("cy",t.y.scale).attr("r",r.point_size)}k+=t.y.height()+r.sep}b+=t.x.width()+r.sep}e.selectAll(".colour").on("mouseover",function(n){var r=t.colour.variable(),a=r?n.key||n[r]:void 0;l.mouseover.call(e,r,a,n),n.key||l.pointover.call(e,r,a,n)}),e.selectAll(".colour").on("mouseout",function(n){var r=t.colour.variable(),a=r?n.key||n[r]:void 0;l.mouseout.call(e,r,a,n),n.key||l.pointout.call(e,r,a,n)})});return l.on("mouseover",function(e,n){if(e){var r=t.colour.scale(""+n),a=/\bcolour([0-9]+)\b/,i=a.exec(r)[0];this.selectAll(".colour").classed("colourlow",!0),this.selectAll("."+i).classed({colourhigh:!0,colourlow:!1})}}),l.on("mouseout",function(){this.selectAll(".colour").classed({colourhigh:!1,colourlow:!1})}),l.on("pointover",function(e,n,r){this.selectAll(".hline").attr("y1",t.y.scale(r)).attr("y2",t.y.scale(r)).style("visibility","visible"),this.selectAll(".vline").attr("x1",t.x.scale(r)).attr("x2",t.x.scale(r)).style("visibility","visible")}),l.on("pointout",function(){this.selectAll(".hline").style("visibility","hidden"),this.selectAll(".vline").style("visibility","hidden")}),d}function u(){var e={region:r(),colour:t(),column:a(),row:a()};e.region.required=!0,e.colour.required=!0;var n={padding:[2,2,2,2],label_padding:4,sep:8},i=d3.dispatch("mouseover","mouseout"),l=o(e,i,function(t){function r(t){return e.column.variable()?t[e.column.variable()]:1}function a(t){return e.row.variable()?t[e.row.variable()]:1}e.region.domain(l.data(),l.schema()),e.colour.domain(l.data(),l.schema()),e.column.domain(l.data(),l.schema()),e.row.domain(l.data(),l.schema());{var o=e.column.variable()?e.column.ticks().length:1,u=e.row.variable()?e.row.ticks().length:1,c=(l.width()-n.padding[1]-n.padding[3]-(o-1)*n.sep)/o,s=(l.height()-n.padding[0]-n.padding[2]-(u-1)*n.sep)/u,d=n.padding[1];n.padding[2]}e.region.width(c).height(s),f(e.region.map_loaded,function(){for(var o=d3.nest().key(r).key(a).entries(l.data()),u=0;u<o.length;++u){for(var h=o[u].values,g=n.padding[2],f=0;f<h.length;++f){var v=svg.append("g").attr("class","graph").attr("transform","translate("+d+","+g+")");v.append("rect").attr("class","background").attr("width",c).attr("height",s),v.selectAll("path").data(h[f].values).enter().append("path").attr("d",e.region.scale).attr("class",e.colour.scale),g+=s+n.sep}d+=c+n.sep}t.selectAll("path").on("mouseover",function(n){var r=n[e.region.variable()];i.mouseover.call(t,e.region.variable(),r,n)}),t.selectAll("path").on("mouseout",function(n){var r=n[e.region.variable()];i.mouseout.call(t,e.region.variable(),r,n)})})});return i.on("mouseover.graph",function(t,e){this.selectAll("path").classed("colourlow",!0),this.selectAll("path").filter(function(n){return n[t]==e}).classed({colourhigh:!0,colourlow:!1})}),i.on("mouseout.graph",function(){this.selectAll("path").classed({colourhigh:!1,colourlow:!1})}),l}function c(t){function e(t){if(r[t])return r[t];if(!n)return[void 0,void 0];var e=n.append("text").text(t),a=e[0][0].getBBox(),i=[1.2*a.width,.65*a.height];return e.remove(),r[t]=i,i}var n=t,r={};return e.svg=function(t){return 0===arguments.length?n:(n=t,this)},e.width=function(t){var n=e(t);return n[0]},e.height=function(t){var n=e(t);return n[1]},e}function s(){function t(t){if(void 0===e)return n+" "+n+"n1 "+n+1;var a=e[1]-e[0],i=Math.sqrt(.9999*(t-e[0]))/Math.sqrt(a),o=Math.floor(i*r);return n+" "+n+"n"+r+" "+n+(o+1)}var e,n="chloro",r=9;return t.domain=function(t){return 0===arguments.length?e:(e=t,this)},t.range=function(t){return 0===arguments.length?n:(n=t,this)},t.ticks=function(){for(var t=(e[1]-e[0])/r,n=e[0],a=[],i=0;r>=i;++i)a.push(n),n+=t;return a},t}function d(){function t(t){if(void 0===e)return r+" "+r+"n1 "+r+1;var a=e.indexOf(t);return r+" "+r+"n"+n+" "+r+(a+1)}var e,n,r="colour";return t.domain=function(t){return 0===arguments.length?e:(e=t,n=t.length,this)},t.range=function(t){return 0===arguments.length?r:(r=t,this)},t.ticks=function(){return e},t}function h(){function t(t){return r(t)}function e(t){var e="function"==typeof a?a(t):a;return e+=i}var n,r=d3.scale.linear(),a=20,i=5,o=10,l=!0;return t.domain=function(t){return t=r.domain(t),0===arguments.length?t:this},t.range=function(t){return t=r.range(t),0===arguments.length?t:this},t.label_size=function(t){return 0===arguments.length?a:(a=t,this)},t.nticks=function(t){return 0===arguments.length?o:(o=t,this)},t.inside=function(t){return 0===arguments.length?l:(l=t?!0:!1,this)},t.nice=function(){var t=r.range(),a=r.domain(),i=Math.abs(t[1]-t[0]),u=g(a[0],a[1],o,e,i);if(l){var c=e(u.labels[0]),s=e(u.labels[u.labels.length-1]),d=c/2+s/2;u=g(a[0],a[1],o,e,i-d),r.range(t[0]<t[1]?[t[0]+c/2,t[1]-s/2]:[t[0]-c/2,t[1]+s/2])}return domain=[u.lmin,u.lmax],r.domain([u.lmin,u.lmax]),n=u.labels,this},t.ticks=function(){return void 0===n?r.ticks(o):n},t}function g(t,e,n,r,a,i,o,l,u,c){function s(t,e,n,r,a,i){for(var o=n*a/(e-t),l=t;1e-10>=l-e;l+=n){var u=r(l,i);if(u>o)return!0}return!1}function d(t,e,n,i,o,l){o=o||[10,1,5,2,2.5,3,4,1.5,7,6,8,9],u=u||[1,0,0,0,-1,0,0,-1,0,0,0,0],l=l||.8,i=i||n;for(var c,d=n-1,h=(e-t)/d,g=Math.floor(Math.log(h)/Math.LN10),f=Math.pow(10,g),v=1-Math.abs(n-i)/i,p=0;p<o.length;p++){var m=o[p]*f,y=Math.floor(t/m)*m,x=y+d*m,b=g+u[p]<0?Math.abs(g+u[p]):0;if(t>=y&&x>=e){var k=1-(p-(0>=y&&x>=0))/o.length,w=(e-t)/(x-y);if(w>l&&!s(y,x,m,r,a,b)){var A=v+k+w;(void 0===c||A>c.score)&&(c={lmin:y,lmax:x,lstep:m,score:A,ndec:b})}}}return c}t=Number(t),e=Number(e),Math.abs(t-e)<1e-10&&(t=.96*t,e=1.04*e),r=r||function(){return 0},a=a||1,l=l||[10,1,5,2,2.5,3,4,1.5,7,6,8,9],u=u||[1,0,0,0,-1,0,0,-1,0,0,0,0],c=c||.8,i=i||2,o=o||Math.ceil(6*n);var h={lmin:t,lmax:e,lstep:e-t,score:-1e8,ndec:0},g=String(h.lstep).split(".");h.ndec=g.length>1?g[1].length:0;for(var f=i;o>=f;f++){var v=d(t,e,f,n,l,c);void 0!==v&&(void 0===h||v.score>h.score)&&(h=v)}for(var p=[],m=h.lmin;m-h.lmax<=1e-10;m+=h.lstep)p.push(m);return h.labels=p,h}grph={};var f=function(t,e){t()?e():setTimeout(function(){f(t,e)},100)};format_numeric=function(t,e,n,r,a){if(isNaN(t))return"";if(void 0===e&&(e=""),void 0===r&&(r=","),void 0===a&&(a=" "),t=void 0!==n?t.toFixed(n):t.toString(),x=t.split("."),x1=x[0],x2=x.length>1?r+x[1]:"",""!==a)for(var i=/(\d+)(\d{3})/;i.test(x1);)x1=x1.replace(i,"$1"+a+"$2");return x1+x2+e},grph.line=l,grph.map=u,this.grph=grph}();